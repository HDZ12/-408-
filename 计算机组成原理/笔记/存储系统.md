# 存储器的分类
## 按在计算机中的作用分类
![按作用分类](https://github.com/user-attachments/assets/b4c44ed1-afb1-443e-958b-5525fcf03704)
### 主存
- 容量较小
- 存取速度较快
- 价格较高
---
- 用来存放计算机运行期间所需的程序和数据
### 外存
- 容量大
- 存取速度较慢
- 单位成本低
---
- 用来存放当前暂时不用的程序和数据以及一些需要永久性保存的信息
- 辅存的内容需要调入主存后才能被CPU访问
### Cache
- 速度可与CPU匹配
- 存储容量小
- 价格高
---
- 位于主存和CPU之间
- 用来存放当前CPU经常使用的指令和数据，以便CPU能高速地访问他们
- 现代计算机通常将其制作在CPU中
## 按存储介质分类
![按存储介质分类](https://github.com/user-attachments/assets/c0bc0f79-6b67-45ed-8b2c-1dc6ad172d45)
## 按存取方式分类
### 随机存储器（RAM）
- 读写方便，使用灵活
- RAM分为静态RAM和动态RAM
- RAM主要为用户编程设置的
---
- 存储器的任何一个存储单元都可以随机存取
- 存取时间与存储单元的物理位置无关
- 主要用于做主存或高速缓冲存储器
### 只读存储器（ROM）
- ROM与RAM一起统一构成主存的地址域
- ROM和RAM的存取方式均为随机存取
- 操作系统的内存储器既有RAM也有ROM
- 广义上的ROM现在可通过电擦除进行写入
- ROM存放系统程序，标准子程序和各类常数
---
- 存储器的内容只能随机读出而不能写入
- 信息一旦写入就不变，断电后也不消失
- 通常用于存放固定不变的程序，常数和汉字字
### 串行访问存储器
- 顺序存取存储器【磁带】
	- 存取速度慢
	- 只能按某种顺序存取
---
直接存取存储器【磁盘，光盘】
- 既不是随机存取也不是按顺序存取
## 按信息可保持性分类
### 易失性存储器
- 断电后，存储信息消失【如RAM】
### 非易失性存储器
断电后，信息仍保存【如ROM，磁表面存储器，光存储器】

![Pasted image 20240605141940](https://github.com/user-attachments/assets/052eb2e0-3b8c-4ad9-9996-99d57bca5576)
## 其他
- 主存储器即主存，存储指令和数据，由RAM和ROM实现
- 主存储器在CPU外，按地址访问
- 控制存储器用来存放实现指令系统的所有微指令，由ROM实现
- 控制存储器在CPU的控制器内，按照微指令的地址访问
# 存储器的性能指标
## 存储容量
$$存储容量 = 存储字数 * 字长（如1M*8bit）$$
- 存储字数表示存储器的地址空间大小【MAR】
- 字长表示一次存取操作的数据量【MDR】
- $1G=1024M;1M=1024K$
- $1s=10^3ms=10^6us=10^9ns=10^{12}ps$
## 存储成本
$$每位价格 = \frac{总成本}{总容量}$$
# 存取速度
$$ 数据传输率 = \frac{数据的宽度}{存储周期}$$
- 数据传输率中的K,M是10的次方不是2 的次方，只有存储容量是二的次方
- 存储周期大于存取时间，因为有一段恢复内部状态的复原时间
---
- 存取时间 $T_a$  = 从启动一次存储器到完成该操作经历的时间
- 存取周期 $T_m$ = 存储器进行一次完整读写操作的全部时间
- 主存带宽 $B_m$ =数据传输速率=每秒从主存进出信息的最大数量=单位 $字/秒$
# 多级层次的存储系统
![Pasted image 20240605144153](https://github.com/user-attachments/assets/877e99f1-a140-4669-9683-89b684f160e4)
- 层次结构：Cache---主存层和主存---辅存
- 前者解决CPU和主存速度不一致的问题
- 后者解决存储系统的容量问题
**层次思想**：上一层的存储器作为低一层存储器的高速缓存，上一层的内容是下一层的的内容的一部分
- Cache和主存能与CPU直接交换信息；辅存要通过主存与CPU交换信息；
- 主存与CPU，Cache，辅存都能交换信息
- 主存和Cache之间的数据调动是由硬件自动完成的，对所有程序员透明
- 主存和辅存之间的数据调动是由操作和os共同完成的【换入换出技术】，对应用程序员透明
# 主存储器
## 【存储器芯片的内部结构】&【主存储器的内部结构】
### 存储芯片的组成
![Pasted image 20240605144433](https://github.com/user-attachments/assets/9537a317-f17d-48f8-8b98-181314a32792)
- 存储体+IO/读写电路+地址译码器+片选控制信号+读写控制信号
- 读RD/写WR控制线：决定芯片是进行读还是写操作
- 片选线CS：确定哪个存储芯片被选中。可用于容量扩充
- 引脚最低数目 = 片选线(1) + 控制线(2, 读RD写WR）+ 数据线 + 地址线
### 主存储器的组成部分
![Pasted image 20240605144607](https://github.com/user-attachments/assets/c8728541-c7bc-4e64-8f22-782cf0be8c5e)
- 数据线的宽度 = MDR的宽度 = 存储字长
- 地址线的宽度 = MAR的宽度 = 存储字数
### 存储体的组成元素
- 存储体【房子】+存储单元【房间】+存储元【房间里面的床】
## 寻址方式
- 📢题目上没有明确指定按字编址，那么就默认是按字节编址【一字节8位】
- 32位的计算机中：32位(bit)=4字节(byte)=1字(word)
- 64位的计算机中：64位(bit)=8字节(byte)=1字(word)
- 存放一个机器字的存储单元，通常称为字存储单元，相应的单元地址叫字地址。
- 存放一个字节的存储单元，称为字节存储单元，相应的地址称为字节地址。
- 如果计算机中可编程的最小单位是字存储单元，则该计算机称为按字寻址的计算机。
- 如果计算机中可编程的最小单位是字节，则该计算机称为按字节寻址的计算机。
- 一个机器字可以包含数个字节，所以一个存储单元也可以包含数个能够单独编制的字节地址

例如，一个16位二进制的字存储单元可存放两个字节，可以按字编址，也可以按字节编址

当用字节编址时，16位的存储单元占两个字节地址。
## 地址复用技术
- 由于DRAM芯片容量大，地址位数多，为了减少地址引脚线，采用地址复用技术
- DRAM因为分两次发送，长度相同，因此地址线可以复用，线数减少了一半
- 引脚数 = 地址线减半 + 数据线不变 + 行通选(1) + 列通选(1) + 读写控制线(2)
- 片选线用行通选线替代↑

- DRAM采用地址复用技术【计算引脚时不要忘记了】，SRAM不采用
## SRAM与DRAM比较

|       | SRAM(static random access memory) | DRAM(Dynamic random access memory) |
| ----- | --------------------------------- | ---------------------------------- |
| 主要用途  | Cache,TLB                         | 主机内存                               |
| 存储信息  | 触发器，双稳态电路                         | 电容                                 |
| 破坏性读出 | 非                                 | 是                                  |
| 需要刷新  | 不要                                | 需要                                 |
| 送行列地址 | 同时送                               | 分两次送                               |
| 运行速度  | 快                                 | 慢                                  |
| 集成度   | 低                                 | 高                                  |
| 存储成本  | 高                                 | 低                                  |
## ROM
### 特点
- 结构简单，位密度比可读写存储器高
- 具有非易失性，可靠性高
### ROM类型
#### 【掩模式只读存储器 MROM】
- 内容在生产过程中写入。可靠性高，集成度高，价格便宜但灵活性差
#### 【一次可编程只读存储器 PROM】
用于用户实现一次性编程。
#### 可擦除可编程只读存储器 EPROM
用于用户实现多次性编程。可多次改写，但次数有限，写入时间过长。
#### FLASH存储器
- 既可在不加电的情况下长期保存信息，又能在线进行快速擦除和重写
- U盘就是基于Flash的只读存储器
- 价格便宜，集成度高，电可擦除重写且擦除重写速度快。
#### 固态硬盘SSD
- SSD即闪存，是一种非易失性存储器，采用随机访问方式
- 可长期保存信息，快速擦除和重写，相比传统硬盘也有读写速度快、低功耗的特性，但价格较高。
## DRAM的刷新
### 常考知识点
#### 什么是刷新
- DRAM电容的电荷维持时间短，即使电源不断电，信息也会自动消失
- 因此每隔一段时间必须刷新，一般取2ms，即刷新周期（再生周期）
- DRAM的刷新是以行为单位的
- 一次完整的刷新过程只需要占用一个存储周期
#### 如下指标
- 刷新周期为2ms；存取周期为0.5μs，即刷新1行的时间为0.5μs；刷新时间=存取周期因为刷新的过程与一次存取相同，只是没有在总线上输入输出
-  存取周期＞真正用于存取的时间因为存取周期内、存取操作结束后仍然需要一些时间来更改状态
-  对128×128的矩阵的存储芯片进行刷新，按存储单元(1B/单元)分为128行128列，即128×128×1B/单元=2^14个单元×1B/单元 = 16KB内存
- 如果是64×64的矩阵，则为64×64×1B/单元=2^12个单元×1B/单元 = 4KB内存
### 集中刷新
#### 集中刷新
在规定的一个刷新周期内，对全部存储单元集中一段时间逐行进行刷新，此刻必须停止读/写操作
#### 刷新过程
- 用0.5μs\*128=64μs的时间对128行进行逐行刷新
- 由于这64μs的时间不能进行读/写操作，故称为“死时间”或访存“死区”
- 由于存取周期为0.5μs，刷新周期为2ms，即4000个存取周期
#### 为什么刷新与存取不能并行
- 因为内存就一套地址译码和片选装置，刷新与存取有相似的过程
- 它要选中一行【这期间片选线、地址线、地址译码器全被占用着】
- 同理，刷新操作之间也不能并行【意味着一次只能刷一行】

![Pasted image 20240605152656](https://github.com/user-attachments/assets/50c5525b-4f1b-4197-acaa-2f80bd26b876)
### 分散刷新
#### 分散刷新
- 是指对每行存储单元的刷新分散到每个存取周期内完成
- 其中，把机器的存取周期$t_c$分成两段，前半段$t_M$用来读/写或维持信息，后半段$t_R$用来刷新
#### 刷新过程
- 在每个存取操作后绑定一个刷新操作，延长了存取周期。
- 这样存取周期就成了0.5μs + 0.5μs =1μs
- 但是由于与存取操作绑定，就不需要专门给出一段时间来刷新了
- 这样，每有128个读取操作，就会把0-127行全部刷新一遍
- 故每隔128μs 就可将存储芯片全部刷新一遍【即刷新周期是1μs×128=128μs远短于2ms】
- 而且不存在停止读/写的死时间，但是存取周期长了，整个系统速度降低了
- 分散刷新的刷新周期128μs ，其实不需要这么频繁，会导致浪费

![Pasted image 20240605180826](https://github.com/user-attachments/assets/be15bcf3-b25c-4046-bdca-afed3f64b99e)
### 异步刷新
- 既可以缩短“死时间”【仍然存在死时间】，又充分利用最大刷新间隔为2ms的特点
#### 刷新过程
- 具体操作为：在2ms内对128行各刷新一遍
- 即每隔15.6μs刷新一行(2000μs/128≈15.6μs)，而每行刷新的时间仍为0.5μs
- 这样，刷新一行只能停止一个存取周期
- 但对每行来说，刷新间隔时间仍为2ms，而死时间为0.5μs
- 相对每一段来说，是集中式刷新，相对整体来说，是分散式刷新

![Pasted image 20240605181024](https://github.com/user-attachments/assets/560765ed-d292-4cec-b6da-dac951e65af9)
# 多模块存储器
- 多模块存储器：一种空间并行技术，利用多个结构完全相同的存储模块的并行工作来提高存储器的吞吐率
## 单体并行存储器
- 【定义】存储器中只有一个存储体，每个存储单元存储m个字，总线宽也为m个字，地址必须顺序排列并处于同一存储单元
- 【通俗理解】换一台多列的快递柜而不能理解为多个一列的快递柜放在一起
- 【过程】在一个存取周期内，从同一地址取出m条指令，然后将指令逐条送至CPU
- 【缺点】指令和数据在主存内必须是连续存放的，一旦遇到转移指令，或操作数不能连续存放，这种方法的效果就不明显
## 多体并行存储器
由多体模块组成，每块都有相同容量和读取速度，各模块都有独立的读写控制电路、MAR和MDR。既能并行工作也能交叉工作。
- 【通俗理解】把多个单列的快递柜拼放在一起，通过加上一些控制电路把他们连接起来，这种叫多体并行存储器。
