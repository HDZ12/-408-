# CPU的概述
## CPU功能
### 指令控制
- 完成取指令、分析指令和执行指令的操作，即程序的顺序控制。
### 操作控制
- 管理并产生由内存取出的每条指令的操作信号
- 把各种操作信号送往相应的部件，从而控制这些部件按指令的要求进行动作。
### 时间控制
- 对各种操作进行时间上的控制，要为每一条指令按时间顺序提供应有的控制信号。
### 数据加工
对数据进行算数和逻辑运算
### 中断处理
- 对计算机运行过程中出现的异常情况和特殊请求进行处理。
## CPU的组成
运算器+控制器
## CPU寄存器的分类
### 用户可见的寄存器
- 可对这类寄存器编程
- e.g. 通用寄存器，PSW，基址寄存器（用于实现多道程序设计或者编制浮动程序），状态/标志寄存器
### 用户不可见的寄存器
- 对用户是透明的
- 保留各种状态信息
- 如溢出标志OF，符号标志SF，零标志ZF，进位标志CF
- PSW中的这些位参与并决定微操作的形成
- 不可对这类寄存器编程
- e.g. MAR，MDR，IR，微程序控制器CM


- 转移指令时，需要判别转移是否成功，若成功则PC修改为转移指令的目标地址，否则下一条指令的地址仍然为PC自增后的地址
- 计算机分两大部分：控制部件和执行部件
	- 控制器就是控制部件，指令寄存器，操作控制器，程序计数器都是控制部件
	- 运算器，存储器，外围设备就是执行部件

- 各寄存器的位数等于什么？【和地址有关的就取决于机器字长，和数据大小有关的就取决于容量】

|通用寄存器     |   PC  | IR | MAR | MDR|
| --- | --- | --- | --- | --- |
|  机器字长   | 存储器容量    | 指令字长 | 指令字长| 机器字长=CPU的位数 |

# 运算器和控制器的对比
## 运算器
### 功能
- 接收从控制器送来的命令并执行相应的动作，对数据进行加工和处理
- 运算器是计算机对数据进行加工处理的中心、
### 组成
| 英文  | 中文       | 简述                            |
|-----|----------|-------------------------------|
| ALU | 算术逻辑单元   | • 进行算术/逻辑运算                   |
| PSW | 程序状态字寄存器 | • PSW存放程序状态字，用于保存系统的运行状态      |
|     |          | • PSW包括状态标志和控制标志              |
|     |          | • 溢出标志OF，符号标志SF，零标志ZF，进位标志CF  |
|     |          | • 中断标志，陷阱标志                   |
| ACC | 累加寄存器    | • 是一个通用寄存器                    |
|     |          | • 暂放ALU运算的结果信息，可作为加法运算的输入端    |
|     | 通用寄存器组   | • 如AX，BX，CX，DX，SP             |
|     |          | • 用于存放操作数和各种地址信息，所以其位数与机器字长相等 |
|     |          | • SP是堆栈指针，用于指示栈顶的地址           |
|     | 暂存寄存器    | • 暂存从主存读来的数据，对应用程序员透明         |
|     | 移位器      | • 对操作数或运算结果进行移位运算             |
|     | 计数器      | • 控制乘除运算的操作步数                 |
## 控制器
### 功能
从主存中取出指令，分析指令并产生有关的操作控制信号
### 组成
| 英文  | 中文       | 简述                                    |
|-----|----------|---------------------------------------|
| PC  | 程序计数器    | • 用于指出下一条指令在主存中的存放地址（PC总是存放指令地址）      |
|     |          | • PC有自增功能                             |
|     |          | • PC的值会根据CPU在执行指令过程中自增或转移到程序的某处(跳转指令) |
|     |          | • PC的位数取决于存储器的容量                      |
| IR  | 指令寄存器    | • 用于保存当前正在执行的那条指令                     |
|     |          | • IR的位数取决于指令字长                        |
| ID  | 指令译码器    | • 仅对操作码字段进行译码，以确定指令的操作功能              |
| MAR | 存储器地址寄存器 | • 存放要访问的主存单元的地址【存地址Memory address】    |
| MDR | 存储器数据寄存器 | • 存放向主存写入的信息或从主存读出的信息【存数据Memory data】 |
|     |          | • n位CPU的n是指数据总线线数（即数据总线的位数=处理器的位数）    |
|     | 时序系统     | • 用于产生各种时序信号，都由统一时钟CLOCK分频得到          |
|     | 微操作信号发生器 | • 根据IR的内容(指令)，PSW的内容(状态信息)和时序信号       |
|     |          | • 产生控制计算机系统所需的各种控制信号                  |
|     |          | • 结构有组合逻辑型和存储逻辑型                      |
# 控制器的功能和工作原理
## 控制器的结构和功能
### 结构
![1719397784183](https://github.com/user-attachments/assets/f364f2f5-acd9-4b60-a143-23b79040280c)
### 连接关系
| 运算器            | • 运算器部件通过数据总线与内存储器、输入设备和输出设备传送数据 |
|----------------|----------------------------------|
| 输入设备和输出设备      | • 输入设备和输出设备通过接口电路与总线相连接          |
| 内存储器、输入设备和输出设备 | • 内存储器、输入设备和输出设备从地址总线接收地址信息      |
|                | • 从控制总线得到控制信号，通过数据总线与其他部件传送数据    |
| 控制器部件          | • 控制器部件从数据总线接受指令信息               |
|                | • 从运算器部件接受指令转移地址，送出指令地址到地址总线     |
|                | • 还要向系统中的部件提供它们运行所需要的控制信号        |
**根据控制器产⽣微操作信号的⽅式的不同，控制器可以分为硬布线控制器和微程序控制器**
## 硬布线控制器和微程序控制器
### 硬布线控制器(RISC)
#### 工作原理
需要结合各微操作的节拍安排，综合分析，写出逻辑表达式，再设计逻辑电路图
#### 特点
- 采用硬件电路，速度快
- 设计难度大，成本高，不易扩展
- 时序系统复杂
#### 基本原理
- 根据指令的要求、当前的时序及外部和内部的状态，按时间顺序发送一系列微操作控制信号
- 是由复杂的组合逻辑门电路和一些触发器构成，又称组合逻辑控制器
#### 硬布线控制单元图
CU的输入信号来源
- 经指令编译器译码产生的
- 时序系统产生的机器周期信号和节拍信号
- 来自执行单元的反馈信号，即标志
微操作控制信号的形成主要与指令译码信号和时钟信号有关
